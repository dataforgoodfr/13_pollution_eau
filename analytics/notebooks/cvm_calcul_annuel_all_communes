{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Calcul du nombre de prélèvements CVM non conforme par commune et par année\n",
    "\n",
    "L'objectif de ce notebook est de partir de la liste de communes cog_communes, et pour chaque commune et chaque année, calculer le nombre de prélèvements non conformes pour le CVM.\n",
    "\n",
    "Il y aura plusieurs aggrégations à faire :\n",
    "\n",
    "- commune (inseecommune) peut avoir plusieurs UDIs (cdreseau) **ET** un UDI peut avoir plusieurs communes (inseecommune) \n",
    "- un prélèvement (referenceprel) peut être rattaché à plusieurs UDIs (cdreseau)\n",
    "- un prélèvement (referenceprel) peut être composé de plusieurs paramètres (cdparametresiseeaux) ; mais dans le cas du CVM, il y a un seul paramètre selon la catégorisation de Pauline, donc c'est plus simple\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">The &#x27;toml&#x27; package isn&#x27;t installed. To load settings from pyproject.toml or ~/.jupysql/config, install with: pip install toml</span>"
      ],
      "text/plain": [
       "The 'toml' package isn't installed. To load settings from pyproject.toml or ~/.jupysql/config, install with: pip install toml"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Connecting to &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Connecting to 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "%load_ext sql\n",
    "%sql duckdb:///../../database/data.duckdb\n",
    "%config SqlMagic.displaylimit = 10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "932902e98ea44fc2a3903efc5647bff3",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>referenceprel</th>\n",
       "            <th>cdparametresiseeaux</th>\n",
       "            <th>valtraduite</th>\n",
       "            <th>limitequal</th>\n",
       "            <th>de_partition</th>\n",
       "            <th>limitequal_float</th>\n",
       "            <th>unite</th>\n",
       "            <th>categorie</th>\n",
       "            <th>cdreseau</th>\n",
       "            <th>inseecommune</th>\n",
       "            <th>datetimeprel</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>00400121459</td>\n",
       "            <td>CHINE</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0,1 µg/L</td>\n",
       "            <td>2020</td>\n",
       "            <td>0.10000000149011612</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>pesticides</td>\n",
       "            <td>004000129</td>\n",
       "            <td>04058</td>\n",
       "            <td>2020-04-09 11:49:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00400121459</td>\n",
       "            <td>CHINOME</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0,1 µg/L</td>\n",
       "            <td>2020</td>\n",
       "            <td>0.10000000149011612</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>pesticides</td>\n",
       "            <td>004000129</td>\n",
       "            <td>04058</td>\n",
       "            <td>2020-04-09 11:49:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00400121459</td>\n",
       "            <td>CHLORB</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0,1 µg/L</td>\n",
       "            <td>2020</td>\n",
       "            <td>0.10000000149011612</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>pesticides</td>\n",
       "            <td>004000129</td>\n",
       "            <td>04058</td>\n",
       "            <td>2020-04-09 11:49:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00400121459</td>\n",
       "            <td>CHLPM</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0,1 µg/L</td>\n",
       "            <td>2020</td>\n",
       "            <td>0.10000000149011612</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>pesticides</td>\n",
       "            <td>004000129</td>\n",
       "            <td>04058</td>\n",
       "            <td>2020-04-09 11:49:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00400121459</td>\n",
       "            <td>CHLX</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0,1 µg/L</td>\n",
       "            <td>2020</td>\n",
       "            <td>0.10000000149011612</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>pesticides</td>\n",
       "            <td>004000129</td>\n",
       "            <td>04058</td>\n",
       "            <td>2020-04-09 11:49:00</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+---------------+---------------------+-------------+------------+--------------+---------------------+-------+------------+-----------+--------------+---------------------+\n",
       "| referenceprel | cdparametresiseeaux | valtraduite | limitequal | de_partition |   limitequal_float  | unite | categorie  |  cdreseau | inseecommune |     datetimeprel    |\n",
       "+---------------+---------------------+-------------+------------+--------------+---------------------+-------+------------+-----------+--------------+---------------------+\n",
       "|  00400121459  |        CHINE        |    0.000    | <=0,1 µg/L |     2020     | 0.10000000149011612 |  µg/L | pesticides | 004000129 |    04058     | 2020-04-09 11:49:00 |\n",
       "|  00400121459  |       CHINOME       |    0.000    | <=0,1 µg/L |     2020     | 0.10000000149011612 |  µg/L | pesticides | 004000129 |    04058     | 2020-04-09 11:49:00 |\n",
       "|  00400121459  |        CHLORB       |    0.000    | <=0,1 µg/L |     2020     | 0.10000000149011612 |  µg/L | pesticides | 004000129 |    04058     | 2020-04-09 11:49:00 |\n",
       "|  00400121459  |        CHLPM        |    0.000    | <=0,1 µg/L |     2020     | 0.10000000149011612 |  µg/L | pesticides | 004000129 |    04058     | 2020-04-09 11:49:00 |\n",
       "|  00400121459  |         CHLX        |    0.000    | <=0,1 µg/L |     2020     | 0.10000000149011612 |  µg/L | pesticides | 004000129 |    04058     | 2020-04-09 11:49:00 |\n",
       "+---------------+---------------------+-------------+------------+--------------+---------------------+-------+------------+-----------+--------------+---------------------+"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "SELECT * FROM int__resultats_udi_communes\n",
    "LIMIT 5"
   ]
  },
  {
   "attachments": {
    "31bc6772-ec83-41bb-9432-f2ad4341d896.PNG": {
     "image/png": "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"
    },
    "524d340b-f46a-4df7-ba88-b4decfdf9da3.PNG": {
     "image/png": "iVBORw0KGgoAAAANSUhEUgAAAbMAAACKCAYAAAAg76RWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACCSSURBVHhe7Z1LiG1peYY1mkBETbwrRINJnJjQOlAMmKQlM504ciqEDAJik0lIhBZiiEFxppN2IEgLThSDONMMWnqQIKidCDqR2Ke9dJqYpKPdiKYTd85T1tu+vudfa+1Ve1edWme/D/zs9d++27/299VlVe1n7EoppZSN02JWSill87SYlVJK2TwtZqWUUjZPi1kppZTN02JWSill87SYlVJK2TwtZqWUUjZPi1kppZTN02JWSill87SYlVJK2TwtZqWUUjZPi1kppZTN02JWSill87SYlVJK2TwtZqWUUjZPi1kppZTN02JWSill87SYlVJK2TwtZqWUUjZPi1kppZTN02JWSill87SYlVJK2TwtZqWUUjZPi1kppZTN02JWSill8xytmD3xxBO7u+++e/eMZzzjlvbBD37wfNXt4Z3vfOdZuwoeffTR3ate9ard5z73ufORq4M4E+/bofsU0Vlz33P/J1/5ylfO1pSLQ1wfeOCB896t72Xd8895znN299xzz/Asbtf74jLO/8tf/vLula985dnrEqNcRCxH9+qdwNGLWRYuBfSqismIUyhmt0vvqTMVd/qMM18uxlROEfvc87frfXFZ57+mmCXEceoLrzuBSy9mQOD5yumqbyhxCsWsXC8uK5mdEkvF7JDEftm0mF09V1LMIAsK1/oxpH5MoAPSgd13331n41rjBYJr3z9XrFI38l1u7sUHlz3lE6h4ae273/3uW4pZ2urydIPde++9T8/7m2BpHhT7qXnweHusYU0sE9nnbxAf2+csHcUTf6fW5/nR3GaudQ7au8+et7/97b8QR/zwfbx63FKm5GU8pf91r3vdmV2MeXxGMkawllj6vbBkU8pM2+b0ga8nnpxjnm3q97HURyOuoLNGps5K83lPSyf20kZ+5L2YMtCR7wtnKTY5Lz+SXEeftX5/aS86fO3SeXL2im/GGnxM8ZX+KR0CW/I9kDGYs5fXvMcffPDBW2y8LK6smDHOPOv8GrRXYzhOkHwNe3QzMu8B8kMbwQHoUFjjByDdPu83fepycq/6HKRswe48cPqKE6+sVz9lLs3Ld80D1/Ih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"
    }
   },
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Pour le bilan annuel**\n",
    "\n",
    "![cvm_année.PNG](attachment:31bc6772-ec83-41bb-9432-f2ad4341d896.PNG)\n",
    "\n",
    "\n",
    "![non_qualifié.PNG](attachment:524d340b-f46a-4df7-ba88-b4decfdf9da3.PNG)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Faire la liste complètes des communes (pour chaque catégorie et années)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>annee</th>\n",
       "            <th>categorie</th>\n",
       "            <th>inseecommune</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>48104</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>51073</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>52114</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>55078</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>55400</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>57640</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>60516</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>62282</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>63003</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>63260</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<span style=\"font-style:italic;text-align:center;\">Truncated to <a href=\"https://jupysql.ploomber.io/en/latest/api/configuration.html#displaylimit\">displaylimit</a> of 10.</span>"
      ],
      "text/plain": [
       "+-------+-----------+--------------+\n",
       "| annee | categorie | inseecommune |\n",
       "+-------+-----------+--------------+\n",
       "|  2024 |    cvm    |    48104     |\n",
       "|  2024 |    cvm    |    51073     |\n",
       "|  2024 |    cvm    |    52114     |\n",
       "|  2024 |    cvm    |    55078     |\n",
       "|  2024 |    cvm    |    55400     |\n",
       "|  2024 |    cvm    |    57640     |\n",
       "|  2024 |    cvm    |    60516     |\n",
       "|  2024 |    cvm    |    62282     |\n",
       "|  2024 |    cvm    |    63003     |\n",
       "|  2024 |    cvm    |    63260     |\n",
       "+-------+-----------+--------------+\n",
       "Truncated to displaylimit of 10."
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --save list_communes\n",
    "WITH\n",
    "annees AS (\n",
    "    SELECT unnest(generate_series(2020, 2024)) as annee\n",
    "    )\n",
    "   \n",
    "SELECT DISTINCT\n",
    "    annees.annee AS annee, \n",
    "    'cvm' AS categorie,\n",
    "    inseecommune ,\n",
    " FROM\n",
    "      int__lien_commune_cdreseau\n",
    " FULL OUTER JOIN\n",
    "       annees\n",
    " ON\n",
    "    int__lien_commune_cdreseau.de_partition = annees.annee"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>annee</th>\n",
       "            <th>categorie</th>\n",
       "            <th>inseecommune</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>2023</td>\n",
       "            <td>cvm</td>\n",
       "            <td>07194</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2020</td>\n",
       "            <td>cvm</td>\n",
       "            <td>07194</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2021</td>\n",
       "            <td>cvm</td>\n",
       "            <td>07194</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>cvm</td>\n",
       "            <td>07194</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2022</td>\n",
       "            <td>cvm</td>\n",
       "            <td>07194</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+-------+-----------+--------------+\n",
       "| annee | categorie | inseecommune |\n",
       "+-------+-----------+--------------+\n",
       "|  2023 |    cvm    |    07194     |\n",
       "|  2020 |    cvm    |    07194     |\n",
       "|  2021 |    cvm    |    07194     |\n",
       "|  2024 |    cvm    |    07194     |\n",
       "|  2022 |    cvm    |    07194     |\n",
       "+-------+-----------+--------------+"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --with list_communes\n",
    "SELECT\n",
    "    *\n",
    "FROM\n",
    "   list_communes\n",
    "WHERE\n",
    "    inseecommune = '07194'"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Test cog pour le final"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>TYPECOM</th>\n",
       "            <th>COM</th>\n",
       "            <th>REG</th>\n",
       "            <th>DEP</th>\n",
       "            <th>CTCD</th>\n",
       "            <th>ARR</th>\n",
       "            <th>TNCC</th>\n",
       "            <th>NCC</th>\n",
       "            <th>NCCENR</th>\n",
       "            <th>LIBELLE</th>\n",
       "            <th>CAN</th>\n",
       "            <th>COMPARENT</th>\n",
       "            <th>de_partition</th>\n",
       "            <th>de_ingestion_date</th>\n",
       "            <th>de_dataset_datetime</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>COM</td>\n",
       "            <td>01001</td>\n",
       "            <td>84</td>\n",
       "            <td>01</td>\n",
       "            <td>01D</td>\n",
       "            <td>012</td>\n",
       "            <td>5</td>\n",
       "            <td>ABERGEMENT CLEMENCIAT</td>\n",
       "            <td>Abergement-Clémenciat</td>\n",
       "            <td>L'Abergement-Clémenciat</td>\n",
       "            <td>0108</td>\n",
       "            <td>None</td>\n",
       "            <td>2024</td>\n",
       "            <td>2025-03-16</td>\n",
       "            <td>20240220</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>COM</td>\n",
       "            <td>01002</td>\n",
       "            <td>84</td>\n",
       "            <td>01</td>\n",
       "            <td>01D</td>\n",
       "            <td>011</td>\n",
       "            <td>5</td>\n",
       "            <td>ABERGEMENT DE VAREY</td>\n",
       "            <td>Abergement-de-Varey</td>\n",
       "            <td>L'Abergement-de-Varey</td>\n",
       "            <td>0101</td>\n",
       "            <td>None</td>\n",
       "            <td>2024</td>\n",
       "            <td>2025-03-16</td>\n",
       "            <td>20240220</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>COM</td>\n",
       "            <td>01004</td>\n",
       "            <td>84</td>\n",
       "            <td>01</td>\n",
       "            <td>01D</td>\n",
       "            <td>011</td>\n",
       "            <td>1</td>\n",
       "            <td>AMBERIEU EN BUGEY</td>\n",
       "            <td>Ambérieu-en-Bugey</td>\n",
       "            <td>Ambérieu-en-Bugey</td>\n",
       "            <td>0101</td>\n",
       "            <td>None</td>\n",
       "            <td>2024</td>\n",
       "            <td>2025-03-16</td>\n",
       "            <td>20240220</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>COM</td>\n",
       "            <td>01005</td>\n",
       "            <td>84</td>\n",
       "            <td>01</td>\n",
       "            <td>01D</td>\n",
       "            <td>012</td>\n",
       "            <td>1</td>\n",
       "            <td>AMBERIEUX EN DOMBES</td>\n",
       "            <td>Ambérieux-en-Dombes</td>\n",
       "            <td>Ambérieux-en-Dombes</td>\n",
       "            <td>0122</td>\n",
       "            <td>None</td>\n",
       "            <td>2024</td>\n",
       "            <td>2025-03-16</td>\n",
       "            <td>20240220</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>COM</td>\n",
       "            <td>01006</td>\n",
       "            <td>84</td>\n",
       "            <td>01</td>\n",
       "            <td>01D</td>\n",
       "            <td>011</td>\n",
       "            <td>1</td>\n",
       "            <td>AMBLEON</td>\n",
       "            <td>Ambléon</td>\n",
       "            <td>Ambléon</td>\n",
       "            <td>0104</td>\n",
       "            <td>None</td>\n",
       "            <td>2024</td>\n",
       "            <td>2025-03-16</td>\n",
       "            <td>20240220</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>COM</td>\n",
       "            <td>01007</td>\n",
       "            <td>84</td>\n",
       "            <td>01</td>\n",
       "            <td>01D</td>\n",
       "            <td>011</td>\n",
       "            <td>1</td>\n",
       "            <td>AMBRONAY</td>\n",
       "            <td>Ambronay</td>\n",
       "            <td>Ambronay</td>\n",
       "            <td>0101</td>\n",
       "            <td>None</td>\n",
       "            <td>2024</td>\n",
       "            <td>2025-03-16</td>\n",
       "            <td>20240220</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>COM</td>\n",
       "            <td>01008</td>\n",
       "            <td>84</td>\n",
       "            <td>01</td>\n",
       "            <td>01D</td>\n",
       "            <td>011</td>\n",
       "            <td>1</td>\n",
       "            <td>AMBUTRIX</td>\n",
       "            <td>Ambutrix</td>\n",
       "            <td>Ambutrix</td>\n",
       "            <td>0101</td>\n",
       "            <td>None</td>\n",
       "            <td>2024</td>\n",
       "            <td>2025-03-16</td>\n",
       "            <td>20240220</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>COM</td>\n",
       "            <td>01009</td>\n",
       "            <td>84</td>\n",
       "            <td>01</td>\n",
       "            <td>01D</td>\n",
       "            <td>011</td>\n",
       "            <td>1</td>\n",
       "            <td>ANDERT ET CONDON</td>\n",
       "            <td>Andert-et-Condon</td>\n",
       "            <td>Andert-et-Condon</td>\n",
       "            <td>0104</td>\n",
       "            <td>None</td>\n",
       "            <td>2024</td>\n",
       "            <td>2025-03-16</td>\n",
       "            <td>20240220</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>COM</td>\n",
       "            <td>01010</td>\n",
       "            <td>84</td>\n",
       "            <td>01</td>\n",
       "            <td>01D</td>\n",
       "            <td>011</td>\n",
       "            <td>1</td>\n",
       "            <td>ANGLEFORT</td>\n",
       "            <td>Anglefort</td>\n",
       "            <td>Anglefort</td>\n",
       "            <td>0110</td>\n",
       "            <td>None</td>\n",
       "            <td>2024</td>\n",
       "            <td>2025-03-16</td>\n",
       "            <td>20240220</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>COM</td>\n",
       "            <td>01011</td>\n",
       "            <td>84</td>\n",
       "            <td>01</td>\n",
       "            <td>01D</td>\n",
       "            <td>014</td>\n",
       "            <td>1</td>\n",
       "            <td>APREMONT</td>\n",
       "            <td>Apremont</td>\n",
       "            <td>Apremont</td>\n",
       "            <td>0114</td>\n",
       "            <td>None</td>\n",
       "            <td>2024</td>\n",
       "            <td>2025-03-16</td>\n",
       "            <td>20240220</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<span style=\"font-style:italic;text-align:center;\">Truncated to <a href=\"https://jupysql.ploomber.io/en/latest/api/configuration.html#displaylimit\">displaylimit</a> of 10.</span>"
      ],
      "text/plain": [
       "+---------+-------+-----+-----+------+-----+------+-----------------------+-----------------------+-------------------------+------+-----------+--------------+-------------------+---------------------+\n",
       "| TYPECOM |  COM  | REG | DEP | CTCD | ARR | TNCC |          NCC          |         NCCENR        |         LIBELLE         | CAN  | COMPARENT | de_partition | de_ingestion_date | de_dataset_datetime |\n",
       "+---------+-------+-----+-----+------+-----+------+-----------------------+-----------------------+-------------------------+------+-----------+--------------+-------------------+---------------------+\n",
       "|   COM   | 01001 |  84 |  01 | 01D  | 012 |  5   | ABERGEMENT CLEMENCIAT | Abergement-Clémenciat | L'Abergement-Clémenciat | 0108 |    None   |     2024     |     2025-03-16    |       20240220      |\n",
       "|   COM   | 01002 |  84 |  01 | 01D  | 011 |  5   |  ABERGEMENT DE VAREY  |  Abergement-de-Varey  |  L'Abergement-de-Varey  | 0101 |    None   |     2024     |     2025-03-16    |       20240220      |\n",
       "|   COM   | 01004 |  84 |  01 | 01D  | 011 |  1   |   AMBERIEU EN BUGEY   |   Ambérieu-en-Bugey   |    Ambérieu-en-Bugey    | 0101 |    None   |     2024     |     2025-03-16    |       20240220      |\n",
       "|   COM   | 01005 |  84 |  01 | 01D  | 012 |  1   |  AMBERIEUX EN DOMBES  |  Ambérieux-en-Dombes  |   Ambérieux-en-Dombes   | 0122 |    None   |     2024     |     2025-03-16    |       20240220      |\n",
       "|   COM   | 01006 |  84 |  01 | 01D  | 011 |  1   |        AMBLEON        |        Ambléon        |         Ambléon         | 0104 |    None   |     2024     |     2025-03-16    |       20240220      |\n",
       "|   COM   | 01007 |  84 |  01 | 01D  | 011 |  1   |        AMBRONAY       |        Ambronay       |         Ambronay        | 0101 |    None   |     2024     |     2025-03-16    |       20240220      |\n",
       "|   COM   | 01008 |  84 |  01 | 01D  | 011 |  1   |        AMBUTRIX       |        Ambutrix       |         Ambutrix        | 0101 |    None   |     2024     |     2025-03-16    |       20240220      |\n",
       "|   COM   | 01009 |  84 |  01 | 01D  | 011 |  1   |    ANDERT ET CONDON   |    Andert-et-Condon   |     Andert-et-Condon    | 0104 |    None   |     2024     |     2025-03-16    |       20240220      |\n",
       "|   COM   | 01010 |  84 |  01 | 01D  | 011 |  1   |       ANGLEFORT       |       Anglefort       |        Anglefort        | 0110 |    None   |     2024     |     2025-03-16    |       20240220      |\n",
       "|   COM   | 01011 |  84 |  01 | 01D  | 014 |  1   |        APREMONT       |        Apremont       |         Apremont        | 0114 |    None   |     2024     |     2025-03-16    |       20240220      |\n",
       "+---------+-------+-----+-----+------+-----+------+-----------------------+-----------------------+-------------------------+------+-----------+--------------+-------------------+---------------------+\n",
       "Truncated to displaylimit of 10."
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql \n",
    "SELECT \n",
    "    *\n",
    "FROM \n",
    "  cog_communes\n",
    "WHERE\n",
    "    TYPECOM = 'COM'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "%%sql \n",
    "WITH\n",
    "cog AS (\n",
    "    SELECT \n",
    "      DEP AS code_departement,\n",
    "      REG AS code_region,\n",
    "      COM AS inseecommune,\n",
    "      LIBELLE AS name_commune,\n",
    "    FROM \n",
    "      cog_communes\n",
    "    WHERE\n",
    "        TYPECOM = 'COM'\n",
    ")\n",
    "    \n",
    "SELECT\n",
    "        inseecommune,\n",
    "        COUNT(code_departement) AS nb_code_departement,\n",
    "        COUNT(code_region) AS nb_code_region,\n",
    "        COUNT(name_commune) AS nb_name_commune,\n",
    "FROM\n",
    "    cog\n",
    "GROUP BY \n",
    "       inseecommune\n",
    "HAVING \n",
    "    nb_code_departement > 1 OR nb_code_region >1 OR nb_name_commune>1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Les résultats par communes - Bilan annuel"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "%%sql \n",
    "WITH\n",
    "communes_year AS (\n",
    "    SELECT\n",
    "        de_partition AS annee,\n",
    "        categorie,\n",
    "        inseecommune,\n",
    "        sum(1) AS nb_analyses,\n",
    "        sum(CASE\n",
    "            WHEN\n",
    "                valtraduite = 0 OR valtraduite = 1 OR valtraduite IS NULL\n",
    "                OR valtraduite IS NULL\n",
    "                OR limitequal_float IS NULL\n",
    "                THEN 1\n",
    "            ELSE 0\n",
    "        END) AS nb_analyses_not_quantify,\n",
    "        sum(CASE\n",
    "            WHEN\n",
    "                limitequal_float IS NOT NULL AND valtraduite > limitequal_float\n",
    "                THEN 1\n",
    "            ELSE 0\n",
    "        END) AS nb_analyses_not_ok,\n",
    "        sum(CASE\n",
    "            WHEN\n",
    "                limitequal_float IS NOT NULL AND valtraduite <= limitequal_float\n",
    "                THEN 1\n",
    "            ELSE 0\n",
    "        END) AS nb_analyses_ok\n",
    "    FROM\n",
    "        int__resultats_udi_communes\n",
    "    WHERE\n",
    "        categorie = 'cvm'\n",
    "    GROUP BY\n",
    "        annee,\n",
    "        categorie,\n",
    "        inseecommune\n",
    ")\n",
    "\n",
    "SELECT\n",
    "    communes_year.annee,\n",
    "    communes_year.inseecommune,\n",
    "    communes_year.categorie,\n",
    "    'bilan annuel' AS periode,\n",
    "    CASE\n",
    "        WHEN communes_year.nb_analyses = 0\n",
    "            THEN 'Pas recherché'\n",
    "        WHEN\n",
    "            communes_year.nb_analyses_not_quantify > 0\n",
    "            AND communes_year.nb_analyses_ok = 0\n",
    "            THEN 'non quantifié'\n",
    "        WHEN\n",
    "            communes_year.nb_analyses > 0\n",
    "            AND communes_year.nb_analyses_not_ok >= 1\n",
    "            THEN '> 0,5 µg/L'\n",
    "        WHEN communes_year.nb_analyses > 0 AND communes_year.nb_analyses_ok >= 1\n",
    "            THEN '<= 0,5 µg/L'\n",
    "        ELSE 'Check SQL'\n",
    "    END AS resultat\n",
    "FROM\n",
    "    communes_year"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###  SQL resultats_ALL_communes : Join avec list_communes_uid pour avoir la liste complète"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "%%sql \n",
    "SELECT\n",
    "    annees.annee,\n",
    "    commune_code_insee,\n",
    "    categorie,\n",
    "    coalesce(resultat,'Pas recherché') AS resultat\n",
    "FROM  \n",
    " list_communes_uid\n",
    "LEFT JOIN \n",
    " resultats_cvm\n",
    "ON\n",
    "    list_communes_uid.annee =  resultats_cvm.annee\n",
    "    AND  list_communes_uid.inseecommune  =  resultats_cvm.inseecommune\n",
    "    AND  list_communes_uid.categorie  =  resultats_cvm.categorie"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "###  Join avec cog pour avoir le nom des communes"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {},
   "source": [
    "%%sql\n",
    "WITH \n",
    "cog AS (\n",
    "    SELECT \n",
    "      DEP AS code_departement,\n",
    "      REG AS code_region,\n",
    "      COM AS inseecommune,\n",
    "      LIBELLE AS name_commune,\n",
    "    FROM \n",
    "      cog_communes\n",
    "    WHERE\n",
    "        TYPECOM = 'COM'\n",
    ")\n",
    "    \n",
    "SELECT\n",
    "  resultats_ALL_communes.*,\n",
    "  cog.DEP AS  code_departement,\n",
    "  cog.REG AS  code_region,\n",
    "  cog.LIBELLE AS name_commune,\n",
    "FROM\n",
    "  resultats_ALL_communes\n",
    "LEFT JOIN  \n",
    "  cog\n",
    "ON \n",
    "  resultats_ALL_communes.inseecommune = cog.inseecommune"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### SQL complet"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "64fd190f17c344858b2dfc009d60ec02",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>inseecommune</th>\n",
       "            <th>commune_nom</th>\n",
       "            <th>periode</th>\n",
       "            <th>categorie</th>\n",
       "            <th>resultat</th>\n",
       "            <th>annee</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>02585</td>\n",
       "            <td>Parcy-et-Tigny</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>05072</td>\n",
       "            <td>Laye</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>05109</td>\n",
       "            <td>Puy-Saint-Pierre</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>09183</td>\n",
       "            <td>Mauvezin-de-Prat</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>10288</td>\n",
       "            <td>Plaines-Saint-Lange</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>11045</td>\n",
       "            <td>Bouriège</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>21199</td>\n",
       "            <td>Corsaint</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>26042</td>\n",
       "            <td>Beauvallon</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>29222</td>\n",
       "            <td>Port-Launay</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2A269</td>\n",
       "            <td>Sari-Solenzara</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<span style=\"font-style:italic;text-align:center;\">Truncated to <a href=\"https://jupysql.ploomber.io/en/latest/api/configuration.html#displaylimit\">displaylimit</a> of 10.</span>"
      ],
      "text/plain": [
       "+--------------+---------------------+--------------+-----------+-------------+-------+\n",
       "| inseecommune |     commune_nom     |   periode    | categorie |   resultat  | annee |\n",
       "+--------------+---------------------+--------------+-----------+-------------+-------+\n",
       "|    02585     |    Parcy-et-Tigny   | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "|    05072     |         Laye        | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "|    05109     |   Puy-Saint-Pierre  | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "|    09183     |   Mauvezin-de-Prat  | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "|    10288     | Plaines-Saint-Lange | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "|    11045     |       Bouriège      | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "|    21199     |       Corsaint      | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "|    26042     |      Beauvallon     | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "|    29222     |     Port-Launay     | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "|    2A269     |    Sari-Solenzara   | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "+--------------+---------------------+--------------+-----------+-------------+-------+\n",
       "Truncated to displaylimit of 10."
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --save resultats_ALL_communes_name\n",
    "WITH\n",
    "annees AS (\n",
    "    SELECT unnest(generate_series(2020, 2024)) AS annee\n",
    "),\n",
    "\n",
    "list_communes_uid AS (\n",
    "    SELECT DISTINCT\n",
    "        annees.annee,\n",
    "        'cvm' AS categorie,\n",
    "        com.inseecommune\n",
    "    FROM\n",
    "        int__lien_commune_cdreseau AS com\n",
    "    FULL OUTER JOIN\n",
    "        annees\n",
    "        ON\n",
    "            com.de_partition = annees.annee\n",
    "),\n",
    "\n",
    "communes_year AS (\n",
    "    SELECT\n",
    "        de_partition AS annee,\n",
    "        categorie,\n",
    "        inseecommune,\n",
    "        sum(1) AS nb_analyses,\n",
    "        sum(CASE\n",
    "            WHEN\n",
    "                valtraduite = 0 OR valtraduite = 1 OR valtraduite IS NULL\n",
    "                OR valtraduite IS NULL\n",
    "                OR limitequal_float IS NULL\n",
    "                THEN 1\n",
    "            ELSE 0\n",
    "        END) AS nb_analyses_not_quantify,\n",
    "        sum(CASE\n",
    "            WHEN\n",
    "                limitequal_float IS NOT NULL AND valtraduite > limitequal_float\n",
    "                THEN 1\n",
    "            ELSE 0\n",
    "        END) AS nb_analyses_not_ok,\n",
    "        sum(CASE\n",
    "            WHEN\n",
    "                limitequal_float IS NOT NULL AND valtraduite <= limitequal_float\n",
    "                THEN 1\n",
    "            ELSE 0\n",
    "        END) AS nb_analyses_ok\n",
    "    FROM\n",
    "        int__resultats_udi_communes\n",
    "    WHERE\n",
    "        categorie = 'cvm'\n",
    "    GROUP BY\n",
    "        annee,\n",
    "        categorie,\n",
    "        inseecommune\n",
    "),\n",
    "\n",
    "int__resultats_communes AS (\n",
    "    SELECT\n",
    "        communes_year.annee,\n",
    "        communes_year.inseecommune,\n",
    "        communes_year.categorie,\n",
    "        'bilan annuel' AS periode,\n",
    "        CASE\n",
    "            WHEN communes_year.nb_analyses = 0\n",
    "                THEN 'Pas recherché'\n",
    "            WHEN\n",
    "                communes_year.nb_analyses_not_quantify > 0\n",
    "                AND communes_year.nb_analyses_ok = 0\n",
    "                THEN 'non quantifié'\n",
    "            WHEN\n",
    "                communes_year.nb_analyses > 0\n",
    "                AND communes_year.nb_analyses_not_ok >= 1\n",
    "                THEN '> 0,5 µg/L'\n",
    "            WHEN communes_year.nb_analyses > 0 AND communes_year.nb_analyses_ok >= 1\n",
    "                THEN '<= 0,5 µg/L'\n",
    "            ELSE 'Check SQL'\n",
    "        END AS resultat\n",
    "    FROM\n",
    "        communes_year\n",
    "),\n",
    "\n",
    "int__resultats_all_communes AS (\n",
    "    SELECT\n",
    "        list_communes_uid.annee,\n",
    "        list_communes_uid.inseecommune,\n",
    "        list_communes_uid.categorie,\n",
    "        coalesce(int__resultats_communes.resultat, 'Pas recherché') AS resultat\n",
    "    FROM\n",
    "        list_communes_uid\n",
    "    LEFT JOIN\n",
    "        int__resultats_communes\n",
    "        ON\n",
    "            list_communes_uid.annee = int__resultats_communes.annee\n",
    "            AND  list_communes_uid.categorie  =  int__resultats_communes.categorie\n",
    "            AND list_communes_uid.inseecommune\n",
    "            = int__resultats_communes.inseecommune\n",
    "),\n",
    "\n",
    "cog AS (\n",
    "    SELECT\n",
    "        dep AS code_departement,\n",
    "        reg AS code_region,\n",
    "        com AS inseecommune,\n",
    "        libelle AS commune_nom\n",
    "    FROM\n",
    "        stg_communes__cog\n",
    "    WHERE\n",
    "        typecom = 'COM'\n",
    ")\n",
    "\n",
    "SELECT\n",
    "    int__resultats_all_communes.inseecommune,\n",
    "    cog.commune_nom,\n",
    "    'bilan annuel' AS periode,\n",
    "    int__resultats_all_communes.categorie,\n",
    "    int__resultats_all_communes.resultat,\n",
    "    int__resultats_all_communes.annee,\n",
    "FROM\n",
    "    int__resultats_all_communes\n",
    "LEFT JOIN\n",
    "    cog\n",
    "    ON\n",
    "        int__resultats_all_communes.inseecommune = cog.inseecommune\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Check"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "f75920d9f959420cb8b2b1240e7679a6",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>inseecommune</th>\n",
       "            <th>commune_nom</th>\n",
       "            <th>periode</th>\n",
       "            <th>categorie</th>\n",
       "            <th>resultat</th>\n",
       "            <th>annee</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+--------------+-------------+---------+-----------+----------+-------+\n",
       "| inseecommune | commune_nom | periode | categorie | resultat | annee |\n",
       "+--------------+-------------+---------+-----------+----------+-------+\n",
       "+--------------+-------------+---------+-----------+----------+-------+"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --with resultats_ALL_communes_name\n",
    "SELECT \n",
    "    *\n",
    "FROM\n",
    "    resultats_ALL_communes_name\n",
    "WHERE\n",
    "    resultat = 'Check SQL'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "b1774df9ef184b57b0d9393638a8f5bd",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>resultat</th>\n",
       "            <th>count_star()</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>158741</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>> 0,5 µg/L</td>\n",
       "            <td>3049</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>non quantifié</td>\n",
       "            <td>8</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>Pas recherché</td>\n",
       "            <td>12358</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+---------------+--------------+\n",
       "|    resultat   | count_star() |\n",
       "+---------------+--------------+\n",
       "|  <= 0,5 µg/L  |    158741    |\n",
       "|   > 0,5 µg/L  |     3049     |\n",
       "| non quantifié |      8       |\n",
       "| Pas recherché |    12358     |\n",
       "+---------------+--------------+"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --with resultats_ALL_communes_name\n",
    "SELECT \n",
    "    resultat,\n",
    "    COUNT(*)\n",
    "FROM\n",
    "    resultats_ALL_communes_name\n",
    "WHERE\n",
    "     categorie = 'cvm'\n",
    "GROUP BY\n",
    "    resultat"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "72d772dfcf3f4acca5cce526df0ac8ac",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>inseecommune</th>\n",
       "            <th>commune_nom</th>\n",
       "            <th>periode</th>\n",
       "            <th>categorie</th>\n",
       "            <th>resultat</th>\n",
       "            <th>annee</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+--------------+-------------+---------+-----------+----------+-------+\n",
       "| inseecommune | commune_nom | periode | categorie | resultat | annee |\n",
       "+--------------+-------------+---------+-----------+----------+-------+\n",
       "+--------------+-------------+---------+-----------+----------+-------+"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --with resultats_ALL_communes_name\n",
    "SELECT \n",
    "    *\n",
    "FROM\n",
    "    resultats_ALL_communes_name\n",
    "WHERE\n",
    "    resultat = 'Check SQL'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "df46b84b91264c1288d8cbc222c0a59e",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>resultat</th>\n",
       "            <th>count_star()</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>> 0,5 µg/L</td>\n",
       "            <td>3049</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>Pas recherché</td>\n",
       "            <td>12358</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>non quantifié</td>\n",
       "            <td>8</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>158741</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+---------------+--------------+\n",
       "|    resultat   | count_star() |\n",
       "+---------------+--------------+\n",
       "|   > 0,5 µg/L  |     3049     |\n",
       "| Pas recherché |    12358     |\n",
       "| non quantifié |      8       |\n",
       "|  <= 0,5 µg/L  |    158741    |\n",
       "+---------------+--------------+"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --with resultats_ALL_communes_name\n",
    "SELECT \n",
    "    resultat,\n",
    "    COUNT(*)\n",
    "FROM\n",
    "    resultats_ALL_communes_name\n",
    "WHERE\n",
    "     categorie = 'cvm'\n",
    "GROUP BY\n",
    "    resultat"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>year</th>\n",
       "            <th>nb_inseecommune</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>2020</td>\n",
       "            <td>34788</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2021</td>\n",
       "            <td>34833</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2022</td>\n",
       "            <td>34874</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2023</td>\n",
       "            <td>34852</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>34809</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+------+-----------------+\n",
       "| year | nb_inseecommune |\n",
       "+------+-----------------+\n",
       "| 2020 |      34788      |\n",
       "| 2021 |      34833      |\n",
       "| 2022 |      34874      |\n",
       "| 2023 |      34852      |\n",
       "| 2024 |      34809      |\n",
       "+------+-----------------+"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    "SELECT\n",
    "    de_partition as year,\n",
    "    COUNT(DISTINCT inseecommune) AS nb_inseecommune\n",
    "FROM \n",
    " edc_communes\n",
    "GROUP BY \n",
    "    1 \n",
    "ORDER BY \n",
    "   1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "a0cdfa280c394746b0667293bfd293fb",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>annee</th>\n",
       "            <th>nb_inseecommune</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>2020</td>\n",
       "            <td>34788</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2021</td>\n",
       "            <td>34833</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2022</td>\n",
       "            <td>34874</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2023</td>\n",
       "            <td>34852</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>2024</td>\n",
       "            <td>34809</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+-------+-----------------+\n",
       "| annee | nb_inseecommune |\n",
       "+-------+-----------------+\n",
       "|  2020 |      34788      |\n",
       "|  2021 |      34833      |\n",
       "|  2022 |      34874      |\n",
       "|  2023 |      34852      |\n",
       "|  2024 |      34809      |\n",
       "+-------+-----------------+"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --with resultats_ALL_communes_name\n",
    " SELECT \n",
    "    annee,\n",
    "    COUNT(DISTINCT inseecommune) AS nb_inseecommune\n",
    " FROM\n",
    "   resultats_ALL_communes_name\n",
    "GROUP BY \n",
    "    1\n",
    "ORDER BY \n",
    "   1"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### commune_code_insee = '07194'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "3d072cfa1dd64e30a067b23ff50aed4a",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>referenceprel</th>\n",
       "            <th>cdparametresiseeaux</th>\n",
       "            <th>valtraduite</th>\n",
       "            <th>limitequal</th>\n",
       "            <th>de_partition</th>\n",
       "            <th>limitequal_float</th>\n",
       "            <th>unite</th>\n",
       "            <th>categorie</th>\n",
       "            <th>cdreseau</th>\n",
       "            <th>inseecommune</th>\n",
       "            <th>datetimeprel</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>00700187059</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>3.600</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>007001617</td>\n",
       "            <td>07194</td>\n",
       "            <td>2022-08-31 13:31:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00700187150</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>1.600</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>007001617</td>\n",
       "            <td>07194</td>\n",
       "            <td>2022-09-14 14:29:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00700187169</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.370</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>007001617</td>\n",
       "            <td>07194</td>\n",
       "            <td>2022-09-21 09:20:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00700187170</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>1.200</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>007001617</td>\n",
       "            <td>07194</td>\n",
       "            <td>2022-09-21 09:05:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00700187171</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>3.100</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>007001617</td>\n",
       "            <td>07194</td>\n",
       "            <td>2022-09-21 09:35:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00700187172</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>3.400</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>007001617</td>\n",
       "            <td>07194</td>\n",
       "            <td>2022-09-21 09:50:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00700187629</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>007001388</td>\n",
       "            <td>07194</td>\n",
       "            <td>2022-10-27 15:59:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00700187813</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.900</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>007001617</td>\n",
       "            <td>07194</td>\n",
       "            <td>2022-10-19 15:29:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00700187753</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>2.700</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>007001617</td>\n",
       "            <td>07194</td>\n",
       "            <td>2022-10-05 11:58:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00700198480</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.260</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2024</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>007001617</td>\n",
       "            <td>07194</td>\n",
       "            <td>2024-03-04 08:51:00</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>\n",
       "<span style=\"font-style:italic;text-align:center;\">Truncated to <a href=\"https://jupysql.ploomber.io/en/latest/api/configuration.html#displaylimit\">displaylimit</a> of 10.</span>"
      ],
      "text/plain": [
       "+---------------+---------------------+-------------+------------+--------------+------------------+-------+-----------+-----------+--------------+---------------------+\n",
       "| referenceprel | cdparametresiseeaux | valtraduite | limitequal | de_partition | limitequal_float | unite | categorie |  cdreseau | inseecommune |     datetimeprel    |\n",
       "+---------------+---------------------+-------------+------------+--------------+------------------+-------+-----------+-----------+--------------+---------------------+\n",
       "|  00700187059  |        CLVYL        |    3.600    | <=0.5 µg/L |     2022     |       0.5        |  µg/L |    cvm    | 007001617 |    07194     | 2022-08-31 13:31:00 |\n",
       "|  00700187150  |        CLVYL        |    1.600    | <=0.5 µg/L |     2022     |       0.5        |  µg/L |    cvm    | 007001617 |    07194     | 2022-09-14 14:29:00 |\n",
       "|  00700187169  |        CLVYL        |    0.370    | <=0.5 µg/L |     2022     |       0.5        |  µg/L |    cvm    | 007001617 |    07194     | 2022-09-21 09:20:00 |\n",
       "|  00700187170  |        CLVYL        |    1.200    | <=0.5 µg/L |     2022     |       0.5        |  µg/L |    cvm    | 007001617 |    07194     | 2022-09-21 09:05:00 |\n",
       "|  00700187171  |        CLVYL        |    3.100    | <=0.5 µg/L |     2022     |       0.5        |  µg/L |    cvm    | 007001617 |    07194     | 2022-09-21 09:35:00 |\n",
       "|  00700187172  |        CLVYL        |    3.400    | <=0.5 µg/L |     2022     |       0.5        |  µg/L |    cvm    | 007001617 |    07194     | 2022-09-21 09:50:00 |\n",
       "|  00700187629  |        CLVYL        |    0.000    | <=0.5 µg/L |     2022     |       0.5        |  µg/L |    cvm    | 007001388 |    07194     | 2022-10-27 15:59:00 |\n",
       "|  00700187813  |        CLVYL        |    0.900    | <=0.5 µg/L |     2022     |       0.5        |  µg/L |    cvm    | 007001617 |    07194     | 2022-10-19 15:29:00 |\n",
       "|  00700187753  |        CLVYL        |    2.700    | <=0.5 µg/L |     2022     |       0.5        |  µg/L |    cvm    | 007001617 |    07194     | 2022-10-05 11:58:00 |\n",
       "|  00700198480  |        CLVYL        |    0.260    | <=0.5 µg/L |     2024     |       0.5        |  µg/L |    cvm    | 007001617 |    07194     | 2024-03-04 08:51:00 |\n",
       "+---------------+---------------------+-------------+------------+--------------+------------------+-------+-----------+-----------+--------------+---------------------+\n",
       "Truncated to displaylimit of 10."
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql\n",
    " SELECT \n",
    "   *\n",
    " FROM\n",
    "   int__resultats_udi_communes\n",
    "WHERE\n",
    "    inseecommune = '07194'\n",
    "    AND categorie = 'cvm'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>inseecommune</th>\n",
       "            <th>commune_nom</th>\n",
       "            <th>periode</th>\n",
       "            <th>categorie</th>\n",
       "            <th>resultat</th>\n",
       "            <th>annee</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>07194</td>\n",
       "            <td>Rochessauve</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>07194</td>\n",
       "            <td>Rochessauve</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2021</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>07194</td>\n",
       "            <td>Rochessauve</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td>> 0,5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>07194</td>\n",
       "            <td>Rochessauve</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td>> 0,5 µg/L</td>\n",
       "            <td>2023</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>07194</td>\n",
       "            <td>Rochessauve</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td>> 0,5 µg/L</td>\n",
       "            <td>2024</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+--------------+-------------+--------------+-----------+-------------+-------+\n",
       "| inseecommune | commune_nom |   periode    | categorie |   resultat  | annee |\n",
       "+--------------+-------------+--------------+-----------+-------------+-------+\n",
       "|    07194     | Rochessauve | bilan annuel |    cvm    | <= 0,5 µg/L |  2020 |\n",
       "|    07194     | Rochessauve | bilan annuel |    cvm    | <= 0,5 µg/L |  2021 |\n",
       "|    07194     | Rochessauve | bilan annuel |    cvm    |  > 0,5 µg/L |  2022 |\n",
       "|    07194     | Rochessauve | bilan annuel |    cvm    |  > 0,5 µg/L |  2023 |\n",
       "|    07194     | Rochessauve | bilan annuel |    cvm    |  > 0,5 µg/L |  2024 |\n",
       "+--------------+-------------+--------------+-----------+-------------+-------+"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --with resultats_ALL_communes_name \n",
    " SELECT \n",
    "   *\n",
    " FROM\n",
    "   resultats_ALL_communes_name\n",
    "WHERE\n",
    "    inseecommune = '07194'\n",
    "    AND categorie = 'cvm'\n",
    "ORDER BY \n",
    "    annee"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### commune_code_insee = '01002'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "9a73592028b441879bd92a338a7ee313",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>referenceprel</th>\n",
       "            <th>cdparametresiseeaux</th>\n",
       "            <th>valtraduite</th>\n",
       "            <th>limitequal</th>\n",
       "            <th>de_partition</th>\n",
       "            <th>limitequal_float</th>\n",
       "            <th>unite</th>\n",
       "            <th>categorie</th>\n",
       "            <th>cdreseau</th>\n",
       "            <th>inseecommune</th>\n",
       "            <th>datetimeprel</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>00100130490</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>001000369</td>\n",
       "            <td>01002</td>\n",
       "            <td>2022-04-26 09:56:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00100139937</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2024</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>001000369</td>\n",
       "            <td>01002</td>\n",
       "            <td>2024-03-26 15:10:00</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+---------------+---------------------+-------------+------------+--------------+------------------+-------+-----------+-----------+--------------+---------------------+\n",
       "| referenceprel | cdparametresiseeaux | valtraduite | limitequal | de_partition | limitequal_float | unite | categorie |  cdreseau | inseecommune |     datetimeprel    |\n",
       "+---------------+---------------------+-------------+------------+--------------+------------------+-------+-----------+-----------+--------------+---------------------+\n",
       "|  00100130490  |        CLVYL        |    0.000    | <=0.5 µg/L |     2022     |       0.5        |  µg/L |    cvm    | 001000369 |    01002     | 2022-04-26 09:56:00 |\n",
       "|  00100139937  |        CLVYL        |    0.000    | <=0.5 µg/L |     2024     |       0.5        |  µg/L |    cvm    | 001000369 |    01002     | 2024-03-26 15:10:00 |\n",
       "+---------------+---------------------+-------------+------------+--------------+------------------+-------+-----------+-----------+--------------+---------------------+"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql \n",
    " SELECT \n",
    "   *\n",
    " FROM\n",
    "   int__resultats_udi_communes\n",
    "WHERE\n",
    "    inseecommune = '01002'\n",
    "    AND categorie = 'cvm'\n",
    "ORDER BY \n",
    "    de_partition"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>inseecommune</th>\n",
       "            <th>commune_nom</th>\n",
       "            <th>periode</th>\n",
       "            <th>categorie</th>\n",
       "            <th>resultat</th>\n",
       "            <th>annee</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>01002</td>\n",
       "            <td>L'Abergement-de-Varey</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td>Pas recherché</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>01002</td>\n",
       "            <td>L'Abergement-de-Varey</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td>Pas recherché</td>\n",
       "            <td>2021</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>01002</td>\n",
       "            <td>L'Abergement-de-Varey</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2022</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>01002</td>\n",
       "            <td>L'Abergement-de-Varey</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td>Pas recherché</td>\n",
       "            <td>2023</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>01002</td>\n",
       "            <td>L'Abergement-de-Varey</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2024</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+--------------+-----------------------+--------------+-----------+---------------+-------+\n",
       "| inseecommune |      commune_nom      |   periode    | categorie |    resultat   | annee |\n",
       "+--------------+-----------------------+--------------+-----------+---------------+-------+\n",
       "|    01002     | L'Abergement-de-Varey | bilan annuel |    cvm    | Pas recherché |  2020 |\n",
       "|    01002     | L'Abergement-de-Varey | bilan annuel |    cvm    | Pas recherché |  2021 |\n",
       "|    01002     | L'Abergement-de-Varey | bilan annuel |    cvm    |  <= 0,5 µg/L  |  2022 |\n",
       "|    01002     | L'Abergement-de-Varey | bilan annuel |    cvm    | Pas recherché |  2023 |\n",
       "|    01002     | L'Abergement-de-Varey | bilan annuel |    cvm    |  <= 0,5 µg/L  |  2024 |\n",
       "+--------------+-----------------------+--------------+-----------+---------------+-------+"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --with resultats_ALL_communes_name \n",
    " SELECT \n",
    "   *\n",
    " FROM\n",
    "   resultats_ALL_communes_name\n",
    "WHERE\n",
    "    inseecommune = '01002'\n",
    "    AND categorie = 'cvm'\n",
    "ORDER BY \n",
    "    annee"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### commune_code_insee = '08031'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "e8751fa7d8504f81ba9ee98d11d1ccf5",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>referenceprel</th>\n",
       "            <th>cdparametresiseeaux</th>\n",
       "            <th>valtraduite</th>\n",
       "            <th>limitequal</th>\n",
       "            <th>de_partition</th>\n",
       "            <th>limitequal_float</th>\n",
       "            <th>unite</th>\n",
       "            <th>categorie</th>\n",
       "            <th>cdreseau</th>\n",
       "            <th>inseecommune</th>\n",
       "            <th>datetimeprel</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>00800092855</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>008000543</td>\n",
       "            <td>08031</td>\n",
       "            <td>2020-12-17 12:45:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00800092483</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.700</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>008000543</td>\n",
       "            <td>08031</td>\n",
       "            <td>2020-11-17 12:44:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00800094118</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2021</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>008000543</td>\n",
       "            <td>08031</td>\n",
       "            <td>2021-05-27 09:19:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00800102498</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.000</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2023</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>008000543</td>\n",
       "            <td>08031</td>\n",
       "            <td>2023-09-22 14:14:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00800106109</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.900</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2024</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>008000543</td>\n",
       "            <td>08031</td>\n",
       "            <td>2024-09-24 12:24:00</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>00800105054</td>\n",
       "            <td>CLVYL</td>\n",
       "            <td>0.800</td>\n",
       "            <td><=0.5 µg/L</td>\n",
       "            <td>2024</td>\n",
       "            <td>0.5</td>\n",
       "            <td>µg/L</td>\n",
       "            <td>cvm</td>\n",
       "            <td>008000543</td>\n",
       "            <td>08031</td>\n",
       "            <td>2024-06-10 12:21:00</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+---------------+---------------------+-------------+------------+--------------+------------------+-------+-----------+-----------+--------------+---------------------+\n",
       "| referenceprel | cdparametresiseeaux | valtraduite | limitequal | de_partition | limitequal_float | unite | categorie |  cdreseau | inseecommune |     datetimeprel    |\n",
       "+---------------+---------------------+-------------+------------+--------------+------------------+-------+-----------+-----------+--------------+---------------------+\n",
       "|  00800092855  |        CLVYL        |    0.000    | <=0.5 µg/L |     2020     |       0.5        |  µg/L |    cvm    | 008000543 |    08031     | 2020-12-17 12:45:00 |\n",
       "|  00800092483  |        CLVYL        |    0.700    | <=0.5 µg/L |     2020     |       0.5        |  µg/L |    cvm    | 008000543 |    08031     | 2020-11-17 12:44:00 |\n",
       "|  00800094118  |        CLVYL        |    0.000    | <=0.5 µg/L |     2021     |       0.5        |  µg/L |    cvm    | 008000543 |    08031     | 2021-05-27 09:19:00 |\n",
       "|  00800102498  |        CLVYL        |    0.000    | <=0.5 µg/L |     2023     |       0.5        |  µg/L |    cvm    | 008000543 |    08031     | 2023-09-22 14:14:00 |\n",
       "|  00800106109  |        CLVYL        |    0.900    | <=0.5 µg/L |     2024     |       0.5        |  µg/L |    cvm    | 008000543 |    08031     | 2024-09-24 12:24:00 |\n",
       "|  00800105054  |        CLVYL        |    0.800    | <=0.5 µg/L |     2024     |       0.5        |  µg/L |    cvm    | 008000543 |    08031     | 2024-06-10 12:21:00 |\n",
       "+---------------+---------------------+-------------+------------+--------------+------------------+-------+-----------+-----------+--------------+---------------------+"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql \n",
    " SELECT \n",
    "   *\n",
    " FROM\n",
    "   int__resultats_udi_communes\n",
    "WHERE\n",
    "    inseecommune = '08031'\n",
    "    AND categorie = 'cvm'\n",
    "ORDER BY \n",
    "    de_partition"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<span style=\"None\">Running query in &#x27;duckdb:///../../database/data.duckdb&#x27;</span>"
      ],
      "text/plain": [
       "Running query in 'duckdb:///../../database/data.duckdb'"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "1e00185f71b744fd8f4586b34eb15f85",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "FloatProgress(value=0.0, layout=Layout(width='auto'), style=ProgressStyle(bar_color='black'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <th>inseecommune</th>\n",
       "            <th>commune_nom</th>\n",
       "            <th>periode</th>\n",
       "            <th>categorie</th>\n",
       "            <th>resultat</th>\n",
       "            <th>annee</th>\n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        <tr>\n",
       "            <td>08031</td>\n",
       "            <td>Aure</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td>> 0,5 µg/L</td>\n",
       "            <td>2020</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>08031</td>\n",
       "            <td>Aure</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2021</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>08031</td>\n",
       "            <td>Aure</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td>Pas recherché</td>\n",
       "            <td>2022</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>08031</td>\n",
       "            <td>Aure</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td><= 0,5 µg/L</td>\n",
       "            <td>2023</td>\n",
       "        </tr>\n",
       "        <tr>\n",
       "            <td>08031</td>\n",
       "            <td>Aure</td>\n",
       "            <td>bilan annuel</td>\n",
       "            <td>cvm</td>\n",
       "            <td>> 0,5 µg/L</td>\n",
       "            <td>2024</td>\n",
       "        </tr>\n",
       "    </tbody>\n",
       "</table>"
      ],
      "text/plain": [
       "+--------------+-------------+--------------+-----------+---------------+-------+\n",
       "| inseecommune | commune_nom |   periode    | categorie |    resultat   | annee |\n",
       "+--------------+-------------+--------------+-----------+---------------+-------+\n",
       "|    08031     |     Aure    | bilan annuel |    cvm    |   > 0,5 µg/L  |  2020 |\n",
       "|    08031     |     Aure    | bilan annuel |    cvm    |  <= 0,5 µg/L  |  2021 |\n",
       "|    08031     |     Aure    | bilan annuel |    cvm    | Pas recherché |  2022 |\n",
       "|    08031     |     Aure    | bilan annuel |    cvm    |  <= 0,5 µg/L  |  2023 |\n",
       "|    08031     |     Aure    | bilan annuel |    cvm    |   > 0,5 µg/L  |  2024 |\n",
       "+--------------+-------------+--------------+-----------+---------------+-------+"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%sql --with resultats_ALL_communes_name \n",
    " SELECT \n",
    "   *\n",
    " FROM\n",
    "   resultats_ALL_communes_name\n",
    "WHERE\n",
    "    inseecommune = '08031'\n",
    "    AND categorie = 'cvm'\n",
    "ORDER BY \n",
    "    annee"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
